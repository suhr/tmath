# Функции

В школьной математике функции определялись правилами вида

$$l(x) := 3x - 2$$

И вычислялись с помощью подстановки:

$$\begin{aligned}
l(1) &= 3 - 2 = 1 \\
l(5) &= 15 - 2 = 13
\end{aligned}$$

Функции, вычисляемые с помощью подстановки, станут нашим основным инструментом.

Но сначала отделим вычисления от равенства.
Запись ${\color{red}e_1} \xrightarrow{\;*\;} {\color{red}e_2}$ означает, что результатом применения нуля или более числа шагов вычисления к выражению ${\color{red}e_1}$ является выражение ${\color{red}e_2}$.

Например, $l(3)$ вычисляется как

$$l(3) \xrightarrow{\;*\;} 3\cdot3 - 2 \xrightarrow{\;*\;} 9 - 2 \xrightarrow{\;*\;} 7$$

Знак вычисления ($\xrightarrow{\;*\;}$) — метасимвол, не являющийся частью выражения.

Отделив вычисление от равенства, мы может рассматривать равенство как высказывание, которое может быть как истинным, так и ложным. Например, $1=1$ это истинное высказывание, когда же $2=3$ — ложное.

Как и остальные выражения, равенства можно вычислять:

$$(2\cdot 3 = 7-1) \xrightarrow{\;*\;} (6 = 7-1) \xrightarrow{\;*\;} (6=6)$$

Поскольку равенство это выражение, каждому уравнению можно сопоставить функцию, применение которой подставляет конкретные значения в уравнение. Например, для уравнения $x^2 - 3x + 2 = 0$ такой функцией будет

$$eq(x) := (x^2 - 3x + 2 = 0)$$

Применяя $eq$ к различным значениям $x$, получаем различные высказывания. Некоторые из них являются истинными:

$$eq(1) \xrightarrow{\;*\;} (1 - 3 + 2 = 0) \xrightarrow{\;*\;} (0 = 0) \\
eq(2) \xrightarrow{\;*\;} (4 - 6 + 2 = 0) \xrightarrow{\;*\;} (0 = 0)$$

Остальные — ложными:

$$\begin{aligned}
eq(0) &\xrightarrow{\;*\;} (2 = 0) \\
eq(3) &\xrightarrow{\;*\;} (9 - 9 + 2 = 0) \xrightarrow{\;*\;} (2=0)
\end{aligned}$$

Значение $x$ является решением уравнения $eq$ в том случае, когда высказывание $eq(x)$ истинно.

Тождества отличаются от уравнений тем, что они истины для всех возможных аргументов. Например, коммутативности сложения соответствует функция $comm(x,y) := (x+y = y+x)$, которая вычисляет истинное высказывание для любых значений $x$ и $y$.

Хотя подстановка значений в выражение не связана напрямую с числами, она называется вычислением не просто так — с помощью функций можно выражать и алгоритмы, в том числе и арифметические операции.

Основная идея — свести задачу к той же задаче, но с другими данными.

Рассмотрим сложение чисел используя камешки. Пусть есть два мешка — в левом три камня, когда же в правом — два. Мы хотим найти сумму этих камней:

$$\{\bullet{\bullet}\bullet\} + \{\bullet\bullet\}$$

Переложив камешек из правого мешка в левый, получаем другую задачу:

$$\{\bullet{\bullet}{\bullet}\bullet\} + \{\bullet\}$$

Переложив ещё один, получаем:

$$\{\bullet{\bullet}{\bullet}{\bullet}\bullet\} + \{\}$$

И здесь мы уже знаем ответ: $\{\bullet{\bullet}{\bullet}{\bullet}\bullet\}$.

Чтобы выразить то же самое в функциях, представим натуральные числа следующим образом:

$$\begin{aligned}
&0 & &1 & &2 & &3 & &\dots \\
&z & &s(z) & &s(s(z)) & &s(s(s(z))) & &\dots
\end{aligned}$$

Константа $z$ означает нуль, когда же $s(n)$ означает число, которое непосредственно следует за числом $n$. Символ $s$ можно рассматривать как функцию — но мы её не вычисляем, а используем выражение буквально.

Выражение $n + k$ можно рассматривать как форму записи выражения $(+)(n, k)$, где $(+)$ это функция двух аргументов. И тогда сложение можно определить как

$$\begin{aligned}
(+)(n, z)  &:= n \\
(+)(n, s(k))  &:= (+)(s(n), k)
\end{aligned}$$

Функция $(+)$ использует саму себя в своём определении. Такие функции называются *рекурсивными*, а непосредственно ссылка функции на себя — *рекурсией*.

Вычислим $3+2$, используя данное нами определение сложение:

$$\begin{aligned}
    s(s(s(0)))   + s(s(0)) &\xrightarrow{\;*\;}  s(s(s(s(0))))  +   s(0) \\
  &\xrightarrow{\;*\;} s(s(s(s(s(0))))) +     0 \\
  &\xrightarrow{\;*\;} s(s(s(s(s(0)))))
\end{aligned}$$

Это весьма неэффективный способ вычисления сложения. Но хороший пример простейшего рекурсивного алгоритма.

Вычислять можно не только равенства и числа, но и сами функции. Для этого введём понятие анонимной функции.

Анонимная функция это выражение вида $λ{\color{red}x}.\; {\color{red}e}$, которое применяется к значениям точно так же, как применялась бы функция $f({\color{red}x}) := {\color{red}e}$.

Например, анонимная функция, которая сопоставляет числу его квадрат пишется как $λn.\; n^2$ и вычисляется как и обычная функция:

$$(λn.\; n^2)(3) \xrightarrow{\;*\;} 3^2 \xrightarrow{\;*\;} 9$$

Определим функцию $add$, результатом которой является функция, которая прибавляет число:

$$add(n) := λk.\;n+k$$

С её помощью можно сложить два числа:

$$add(3)(4) \xrightarrow{\;*\;} (λk.\; 3+k)(4) \xrightarrow{\;*\;}7$$

Любую функцию двух и более аргументов можно представить как функцию одного аргумента, результатом которой является другая функция. Такое преобразование называется каррированием.
